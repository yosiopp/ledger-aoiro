# 仕訳入力アシスタント

このプロジェクトは hledger を使った青色申告の帳簿管理システムです。ユーザーの取引内容を聞き取って、適切な仕訳を作成し、対応する月次ファイルに追記します。

## 実行手順

1. **取引情報の確認**
   - 日付（YYYY/MM/DD形式）
   - 取引内容（何を購入/受領したか）
   - 金額
   - 支払方法（現金、銀行振込、クレジットカードなど）

2. **勘定科目の選択**
   - `ledger/accounts.ledger` を読んで利用可能な勘定科目を確認
   - 取引内容に最適な勘定科目を選択
   - 新しい勘定科目が必要な場合は、ユーザーに確認してから `accounts.ledger` に追加

3. **仕訳の作成**
   - hledger形式で仕訳を作成（複式簿記）
   - フォーマット例：
     ```
     YYYY/MM/DD * 取引内容
         勘定科目1              金額 JPY
         勘定科目2
     ```

4. **ファイルへの追記**
   - 該当月のファイル（例：`ledger/2026/01.ledger`）を特定
   - 年度ディレクトリや月次ファイルが存在しない場合は作成
   - 仕訳をファイルの末尾に追記

5. **検証の実行**
   - `./lgr validate` で勘定科目の検証
   - `./lgr check` で貸借一致チェック
   - エラーがあれば修正

6. **memo記録の推奨**
   - 必要に応じて `memo/YYYY/MM/` に判断根拠を記録することを提案
   - 特に按分や勘定科目選択の理由は重要

## 勘定科目の基本構造

- **A:** 資産（現金、銀行、売掛金など）
- **L:** 負債（買掛金、未払金、クレジットカードなど）
- **E:** 純資産（事業主貸、事業主借など）
- **R:** 収益（売上、雑収入など）
- **X:** 費用（各種経費）

## よくある仕訳パターン

### 経費の支払い（銀行振込）
```
2026/01/15 * 通信費（インターネット料金）
    X:通信費                   5000 JPY
    A:銀行:事業用
```

### 経費の支払い（クレジットカード）
```
2026/01/20 * 消耗品購入
    X:消耗品費                 3800 JPY
    L:クレジットカード
```

### 売上の入金
```
2026/01/25 * ○○社 案件報酬
    A:銀行:事業用            150000 JPY
    R:売上
```

### 事業主貸（生活費の引き出し）
```
2026/01/30 * 生活費
    E:事業主貸              100000 JPY
    A:銀行:事業用
```

### 家事按分が必要な経費
```
2026/01/15 * 自宅兼事務所の電気代（事業按分50%）
    X:水道光熱費              5000 JPY
    A:銀行:事業用
```
※按分の根拠は必ず memo に記録するよう促す

## 注意事項

- 新しい勘定科目を使う場合は、必ず先に `ledger/accounts.ledger` に定義を追加
- 金額の単位は必ず `JPY` を付ける
- 取引内容は具体的に記載（後で見て分かるように）
- 家事按分が必要な経費は、按分比率と根拠を必ず確認
- 年度や月のディレクトリ/ファイルが存在しない場合は自動作成
